DROP SCHEMA IF EXISTS ViaTelecom;

CREATE SCHEMA IF NOT EXISTS ViaTelecom;

USE ViaTelecom;

CREATE TABLE spr_addresses(
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
country VARCHAR (50) NOT NULL,
city VARCHAR (100) NOT NULL,
street VARCHAR (100) NOT NULL,
house INT (15) NOT NULL,
flat INT (15) NOT NULL
)ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE spr_contacts(
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
phone_number BIGINT (15) NOT NULL,
email VARCHAR (50) NOT NULL
)ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE spr_roles(
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(50) UNIQUE NOT NULL
 )ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;
 
 CREATE TABLE spr_bills(
 id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
 number VARCHAR(20) UNIQUE NOT NULL,
 value INT(15) NOT NULL
 )ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;
 
CREATE TABLE users (
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
login VARCHAR(50) UNIQUE NOT NULL,
password VARCHAR (200) NOT NULL,
first_name VARCHAR (50) NOT NULL,
last_name VARCHAR (50) NOT NULL,
blocked TINYINT(5) NOT NULL,
spr_bills_id INT(15) NOT NULL,
spr_addresses_id INT (15) NOT NULL,
spr_contacts_id INT(15) NOT NULL,
spr_roles_id INT(15) NOT NULL,
FOREIGN KEY (spr_bills_id)
      REFERENCES spr_bills(id)
      ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (spr_addresses_id)
      REFERENCES spr_addresses(id)
      ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (spr_contacts_id)
      REFERENCES spr_contacts(id)
      ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (spr_roles_id)
      REFERENCES spr_roles(id)
      ON UPDATE CASCADE ON DELETE CASCADE
 )ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;


CREATE TABLE spr_services(
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(15) NOT NULL
)ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

CREATE TABLE tariffs(
id INT(15) NOT NULL PRIMARY KEY AUTO_INCREMENT,
spr_services_id INT(15) NOT NULL,
name VARCHAR(50) NOT NULL,
price INT(15) NOT NULL,
description VARCHAR(200) NOT NULL,
FOREIGN KEY (spr_services_id)
      REFERENCES spr_services(id)
      ON UPDATE CASCADE ON DELETE CASCADE
)ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;



CREATE TABLE user_orders(
users_id INT(15) NOT NULL,
tariffs_id INT(15) NOT NULL,
FOREIGN KEY (users_id)
      REFERENCES users(id)
      ON UPDATE CASCADE ON DELETE CASCADE,
FOREIGN KEY (tariffs_id)
      REFERENCES tariffs(id)
      ON UPDATE CASCADE ON DELETE CASCADE
)ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;     

 